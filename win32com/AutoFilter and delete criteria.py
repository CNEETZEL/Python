import win32com
import win32com.client as win32
win32c = win32.constants
import os

Input = os.path.split(os.path.split(os.path.realpath(__file__))[0])[-2] + '\\Input\\CDC.xls'

excel = win32.gencache.EnsureDispatch('Excel.Application')
wb = excel.Workbooks.Open(Input)
ws = wb.ActiveSheet

##############################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################
######Filtra y borra segun criterio
##############################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################
# Limpiar_Criterio(WorkSheet, Rango inicial, Numero de columna del criterio, criterio)
def Limpiar_Criterio(WS, RNG, NumeroDeColumna, Criterio):
  WS.Range(RNG).CurrentRegion.AutoFilter(NumeroDeColumna, Criterio)
  LR = excel.Cells(WS.Rows.Count, "A").End(win32c.xlShiftUp).Row
  WS.Range(WS.Cells(2, 1), ws.Cells(LR, NumeroDeColumna)).SpecialCells(Type=win32c.xlCellTypeVisible).Delete(Shift=win32c.xlShiftUp)
  WS.AutoFilterMode = False
  return Limpiar_Criterio
Limpiar_Criterio(ws, "A1", 3, "<>NOT READY")