import win32com
import win32com.client as win32
win32c = win32.constants
import os

Input = os.path.split(os.path.split(os.path.realpath(__file__))[0])[-2] + '\\Input\\CDC.xls'

excel = win32.gencache.EnsureDispatch('Excel.Application')
wb = excel.Workbooks.Open(Input)
ws = wb.ActiveSheet

##############################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################
######AutoFill
##############################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################
# Afill(WorkSheet, range start to auto complete, column where the last range will be counted)
# Afill(WorkSheet, Rango inicial del auto completado, columna donde se contara la ultima fila)
def AFill(WS,StartRange, COLUMNLR):
  LR = WS.Cells(WS.Rows.Count, COLUMNLR).End(win32c.xlShiftUp).Row
  LETTER = StartRange.join(re.findall("[a-zA-Z]+", StartRange))
  return WS.Range(StartRange).AutoFill(ws.Range(StartRange + ':' + LETTER + '%d'%LR), win32c.xlFillDefault)
AFill(ws,"C3","B")
